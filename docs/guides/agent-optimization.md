# Agent Optimization & Efficiency Guide

> **AI Agent(Antigravity)와의 협업 효율을 극대화하기 위한 가이드**
>
> 사용자의 팁(캐싱, 요청 최적화, 배치 처리)을 기반으로, 프로젝트 개발 과정에서 API 호출을 줄이고 생산성을 높이는 구체적인 방법을 정의합니다.

---

## 1. Context Caching & Optimization (문맥 최적화)

반복적으로 동일한 정보를 Agent에게 제공하는 것은 토큰 낭비입니다. 프로젝트의 핵심 문맥을 파일로 구조화하여 "참조"만으로 충분하게 만듭니다.

### ✅ 전략
- **Single Source of Truth**: 프로젝트 상태는 `CLAUDE.md`와 `project-todo.md`에만 유지합니다. Agent는 매번 전체 코드를 읽는 대신 이 파일들만 먼저 읽습니다.
- **Rule-based Context**: 코딩 컨벤션, 아키텍처 원칙은 `constitution.md`에 정의하고, 프롬프트에서는 "헌법을 준수해"라고만 지시합니다.

### 🚀 적용 방법
- 작업을 시작할 때: "현재 상태 확인해줘" (X) → Agent가 스스로 `CLAUDE.md`를 읽도록 훈련됨 (O)
- 규칙을 설명할 때: "컴포넌트는 200줄 이하로 만들고..." (X) → "Constitution의 컴포넌트 원칙을 따라줘" (O)

---

## 2. Request Batching (요청 배치 처리)

작은 변경 사항을 여러 번 요청하는 대신, 관련된 작업을 묶어서 한 번에 요청합니다. 이는 "Tiered SDD"와 결합하여 강력한 효과를 냅니다.

### ✅ 전략
- **Tier 2/3 작업 묶기**: 관련된 UI 수정이나 버그 픽스는 이슈 3~4개를 모아서 하나의 프롬프트로 요청합니다.
- **Workflow 활용**: 복잡한 작업(Tier 1)은 사전 정의된 `.agent/workflows`를 통해 일련의 과정을 한 번의 지시로 수행합니다.

### 🚀 적용 예시
**Bad (개별 호출):**
1. "헤더 색상 바꿔줘."
2. "아, 그리고 푸터 링크도 수정해줘."
3. "버튼 스타일도 좀 이상한데 고쳐줘."

**Good (배치 처리):**
"다음 UI 수정 사항들을 일괄 적용해줘 (Tier 3):
1. 헤더 배경색을 `bg-slate-900`으로 변경
2. 푸터의 'Terms' 링크를 `/terms`로 수정
3. 모든 Primary 버튼에 `hover:scale-105` 효과 추가"

---

## 3. Workflow Automation (워크플로우 자동화)

자주 반복되는 패턴(새 기능 구현, 마이그레이션 등)을 "매크로"처럼 정의하여 프롬프트 길이를 최적화합니다.

### ✅ 구현된 워크플로우 (`.agent/workflows/`)
- **`feature-tier2.md`**: Tier 2 기능 구현 (Plan → Implement → Verify) 자동화
- **`db-migration.md`**: 안전한 DB 마이그레이션 절차 자동화

### 🚀 사용법
- "/run feature-tier2 [기능명]" 명령어로 복잡한 절차를 한 번에 실행 (구현 예정)

---

## 4. Codebase Optimization (코드베이스 최적화)

Agent가 코드를 더 쉽게 이해하고 수정할 수 있도록 프로젝트 구조를 최적화합니다.

- **Barrel Files (`index.ts`) 활용**: import 구문을 줄여 토큰 절약
- **명확한 타입 정의**: `types/` 폴더에 타입을 중앙화하여 Agent가 타입 추론에 쓰는 리소스 절약
- **JSDoc 활용**: 복잡한 로직에 "Why"를 설명하는 주석을 달아 Agent의 분석 시간 단축

---

**결론**: 이 가이드를 통해 불필요한 상호작용을 줄이고, **"생각하는 시간"**을 확보하여 더 고차원적인 문제 해결에 집중합니다.
