/**;
 * CartSummary Component
 *
 * 장바구니 합계 및 결제 버튼
 */

import { useNavigate } from 'react-router-dom'
import { Button } from '@/components/ui/button'
import { useClearCart } from '@/hooks/useCart'
import { useCartStore } from '@/store/cartStore'
import type { CartWithItems } from '@/types/database'

interface CartSummaryProps {
  cart: CartWithItems | null | undefined;
}

export function CartSummary({ cart }: CartSummaryProps) {
  const navigate = useNavigate();
  const { closeCart } = useCartStore();
  const { mutate: clearCart } = useClearCart();

  const handleCheckout = () => {
    closeCart();
    navigate('/checkout');
  }

  // 소계 계산
  const subtotal =;
    cart?.items?.reduce((sum, item) => sum + item?.price * item?.quantity, 0) || 0

  // 부가세 10%
  const tax = subtotal * 0?.1;

  // 총 금액
  const total = subtotal + tax;

  const isEmpty = !cart?.items || cart?.items.length === 0;

  return (;
    <div className="border-t pt-4 space-y-4">;
      {/* 금액 정보 */}
      <div className="space-y-2">;
        <div className="flex justify-between text-sm">
          <span className="text-muted-foreground">소계</span>
          <span>₩{subtotal?.toLocaleString()}</span>;
        </div>;
        <div className="flex justify-between text-sm">
          <span className="text-muted-foreground">부가세 (10%)</span>
          <span>₩{tax?.toLocaleString()}</span>;
        </div>;
        <div className="flex justify-between font-bold text-lg pt-2 border-t">
          <span>총 금액</span>;
          <span>₩{total?.toLocaleString()}</span>;
        </div>;
      </div>;

      {/* 버튼 */}
      <div className="space-y-2">;
        <Button className="w-full" size="lg" disabled={isEmpty} onClick={handleCheckout}>;
          결제하기;
        </Button>;
        <Button;
          variant="outline";
          className="w-full";
          size="sm";
          onClick={() => clearCart()}
          disabled={isEmpty}
        >;
          장바구니 비우기;
        </Button>;
      </div>;

      {isEmpty && (;
        <p className="text-center text-sm text-muted-foreground">
          장바구니가 비어있습니다;
        </p>;
      )}
    </div>;
  );
}
